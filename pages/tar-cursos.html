<style>
  .area-gris{ overflow: auto; }
</style>
<!-- PAGE tar-cursos !-->
<div class="page bg-white subpage" data-page="tar-cursos" data-scroll="top" data-start="right" data-StatusBar="#E18560">
        <div class="content" id="content">
            <div class="p10" style="position: relative;" id="tarinfo" >
                <div class="back-text" onclick="app.backNavigator();"><span class="fl" translate-text="opc-intranet">{{opc-intranet}}</span></div>
                <div class="title-h1">
                    <span class="" translate-text="tar-cursos">{{tar-cursos}}</span>
                </div>
                <span class="mt-5" translate-text="tar-cursos-ley">{{tar-cursos-ley}}</span>

                <div class="circle-area-curso">
                        <div class="arrow-right-orange"></div>
                        <div class="label" translate-text="tar-cursos-opc1"></div>
                        <div class="label-price">23.432,25</div>
                </div>

                <div class="circle-area-curso">
                    <div class="arrow-right-orange"></div>
                    <div class="label" translate-text="tar-cursos-opc2"></div>
                    <div class="label-price">46.864,52</div>
                </div>

                <div class="circle-area-curso">
                    <div class="circle-ckeck" id="despesesMed" onclick="despesesMed()"></div>
                    <div class="arrow-right-orange"></div>
                    <div class="label" translate-text="tar-cursos-opc3"></div>
                </div>
                
                <div class="circle-area-curso" id="opc4">
                    <div class="arrow-right-orange"></div>
                    <div class="label" translate-text="tar-cursos-opc4"></div>
                    <div class="label-price">6.000</div>
                </div>

                <div class="circle-area-curso" id="opc5">
                    <div class="arrow-right-orange"></div>
                    <div class="label" translate-text="tar-cursos-opc5"></div>
                    <div class="label-price">ILIMITADO</div>
                </div>
                
                <div class="circle-area-curso" id="precio-final">
                    <div class="label" translate-text="tar-cursos-opc6"></div>
                    <div class="label-price" id="valor">0</div>
                </div>

                <div class="area-gris">

                        <input type="hidden" id="no-medico" name="no-medico" value="0" />

                        <div class="box-ask" onclick="openSelectNumber()" >
                                <div class="label" translate-text="tar-cursos-opc7"></div>
                                <span id="numero_personas_text"></span> 
                                <input type="hidden" id="numero_personas" name="numero_personas" />
                        </div>
                        <div class="divider" data-h="20"></div>
                        <div class="box-ask" id="step2">
                            <div class="label" translate-text="tar-cursos-opc8"></div>
                            <div class="label width-50 d-inline fl">
                                <label translate-text="tar-cursos-opc9" for="fecha_inicio"></label>
                                <input type="date" id="fecha_inicio" name="fecha_inicio" class="fecha-trasparente" >
                            </div>
                            
                            <div class="label width-50 d-inline fl">
                                <label translate-text="tar-cursos-opc10" for="fecha_fin"></label>
                                <input type="date" id="fecha_fin" name="fecha_fin" class="fecha-trasparente" >
                            </div>
                            <div class="divider" data-h="20"></div>
                            <div class="label" translate-text="tar-cursos-opc11" id="step3"></div>
                            <textarea id="descripcion" name="descripcion" style="
                            width: 100%;
                            border-radius: 5px;
                            padding: 10px;
                            font-size: 18px;
                        "></textarea>

                            <div class="divider" data-h="20"></div>
                            <label class="label">
                                <span translate-text="tar-cursos-opc12"></span>
                                <input type="file" name="name-file"> 
                            </label>
                            <div class="divider" data-h="20"></div>
                            <div class="label" translate-text="tar-cursos-opc13">
                                <span translate-text="tar-cursos-opc13"></span>
                                <input type="file" name="name-file-2">
                            </div>
                    </div>

                </div>

            </div>
        </div>         
</div>
<!-- END tar-cursos !-->
<script>
    
    $(function(){
 
        $("#numero_personas,#fecha_inicio,#fecha_fin, #descripcion ").on({ 
					 
					change : function(){
							tarifica()
					}
            })
    
    })
    function validForm(){

            if (!$('#numero_personas').val()){
                openSelectNumber();
                return false
            }
               
            if (!$('#fecha_inicio').val() || $('#fecha_inicio').val()){

            }


    }

    function tarifica(){
	
    var nPersonas, fecha_ini,fecha_fin,descripcion
    
    nPersonas    = $('#numero_personas').val();
    fecha_ini    = $('#fecha_inicio').val();
    fecha_fin    = $('#fecha_fin').val();
    descripcion  = $('#descripcion').val();
    medico		 = $('#no-medico').val();
    
    var f1 = fecha_ini.split('/'); //31 de diciembre de 2015
    var f2 = fecha_fin.split('/'); ; //30 de noviembre de 2014
    
    f1 = new Date(f1[2], f1[1], f1[0]); //31 de diciembre de 2015
    f2 = new Date(f2[2], f2[1], f2[0]); //30 de noviembre de 2014
    
    if (nPersonas &&  fecha_ini && fecha_fin){
        
         if (f2 < f1 ){
             alert("Data final invÃƒ lida");
             return false;
         }
      
         
        
                app.ajax({ type   : "POST",
                           datos    : {
                            opc : 'tarifica',
                            personas : nPersonas,
                            fini : fecha_ini,
                            fend : fecha_fin,
                            descripcion : descripcion,
                            descripcion : medico,
                         },
                         cache  : false,
                         success: function(response){
                            console.log(response);
                             if (response.error) {
                                fn.alert(response.error)
                             }
                             $('.token').val(response.token);
                             $('#valor').html(response.primaFinal) 
                         }
                })
       
    }
                  
    
}


    function areagris(){
            var hw  =  $(window).height();
            var ht  =  $('#tarinfo').height();
            var dif =  (hw-ht) - 122;
            $('.area-gris').height(dif)
    }
   
    var data = { numbers: [] };

    for(i=1;i<=150;i++){
        data.numbers.push({description : i});  
    }

    
    var config = {  
        title: "",
        items:[
            [data.numbers]
        ],
        wrapWheelText: true,
        positiveButtonText: "Ok",
        negativeButtonText: "Cancelar"
    };

    function openSelectNumber(){
 
            window.SelectorCordovaPlugin.showSelector(config, function(result) {
                $('#numero_personas').val(result[0].description);
                $('#numero_personas_text').html( result[0].description );
                validForm()
            }, function() {
                
            });
    }

    function despesesMed(){
            if (!$('#despesesMed').is('.off')){
                    $('#despesesMed').addClass('off')
                    $('#opc4, #opc5').addClass('invisible');
                    $('#no-medico').val(1)
            }else{
                    $('#despesesMed').removeClass('off')
                    $('#opc4, #opc5').removeClass('invisible');
                    $('#no-medico').val(0)
            }
    }

    
    var options = {
            date: new Date(),
            mode: 'date'
        };

    function onSuccess(date) {
            alert('Selected date: ' + date);
    }

    function onError(error) { // Android only
            alert('Error: ' + error);
    }

    // function getCalendarInici() { datePicker.show(options, onSuccess, onError); } 
       


</script>